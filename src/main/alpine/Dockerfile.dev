FROM krmcbride/alpine:{{ .Env.version }}-base

RUN apk add --no-cache \
    perl \
    less \
    git \
    openssh-client \
    vim \
    ctags \
    ncurses \
    zsh \
    bc \
  && git clone https://github.com/amix/vimrc.git /usr/local/vim_runtime \
  && ( \
    cd /usr/local/vim_runtime \
    && git checkout -b tmp 391f8b5c0680becede604ca84a60ed57f56e42bd \
    && rm -rf .git \
  ) \
  && git clone https://github.com/robbyrussell/oh-my-zsh.git /usr/local/oh-my-zsh \
  && ( \
    cd /usr/local/oh-my-zsh \
    && git checkout -b tmp d848c94804918138375041a9f800f401bec12068 \
    && rm -rf .git \
  ) \
  && git clone https://github.com/bhilburn/powerlevel9k.git  /usr/local/oh-my-zsh/custom/themes/powerlevel9k \
  && ( \
    cd /usr/local/oh-my-zsh/custom/themes/powerlevel9k \
    && git checkout -b tmp 4be16020b7cd7241b75c23db9f5bd3d4fce84686 \
    && rm -rf .git \
  )

COPY diff-* todo.txt/todo.sh /usr/local/bin/
COPY my_configs.vim /usr/local/vim_runtime/
COPY *.aliases.bash /usr/local/bash-it/aliases/enabled/
COPY *.completion.bash /usr/local/bash-it/completion/enabled/
COPY *.plugin.bash /usr/local/bash-it/plugins/enabled/
COPY *aliases.zsh /usr/local/oh-my-zsh/custom/
COPY gitconfig /etc/
COPY dotfiles/.vimrc ./dotfiles/.zshrc /root/

CMD ["/bin/zsh"]
